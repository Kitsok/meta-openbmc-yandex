/dts-v1/;
/plugin/;

#include <dt-bindings/gpio/gpio.h>
#include <dt-bindings/gpio/aspeed-gpio.h>

/ {
	compatible = "aspeed,ast2400";

	fragment@0 {
		target-path = "/";
		__overlay__ {
			model = "Gigabyte CB v3.0";
		};
	};

	fragment@1 {
		target = <&leds>;
		__overlay__ {
			bmc_lan {
				label = "bmc_lan";
				gpios = <&gpio ASPEED_GPIO(B, 5) GPIO_ACTIVE_HIGH>;
				linux,default-trigger = "netdev";
			};
		};
	};

	fragment@2 {
		target = <&mac1>;
		#address-cells = <1>;
		#size-cells = <0>;
		__overlay__ {
			#address-cells = <1>;
			#size-cells = <0>;
			compatible = "faraday,ftgmac100", "aspeed,ast2400-mac";
			reg = <0x1e680000 0x180>;
			interrupts = <3>;
			status = "okay";
			no-hw-checksum;

			pinctrl-names = "default";
			pinctrl-0 = <&pinctrl_rgmii2_default &pinctrl_mdio2_default>;

			phy-mode = "rgmii-id";

			fixed-link {
				speed = <1000>;
				max-speed = <1000>;
				full-duplex;
			};

			mdio {
				#address-cells = <1>;
				#size-cells = <0>;

				switch: ethernet-switch@1e {
					#address-cells = <1>;
					#size-cells = <0>;
					compatible = "brcm,bcm53128";
					reset-gpios = <&gpio ASPEED_GPIO(H, 0) GPIO_ACTIVE_LOW>;
					reg = <30>;

					ports {
						port0@0 {
							reg = <0>;
							label = "lan1";
						};

						port1@1 {
							reg = <1>;
							label = "lan2";
						};

						port2@2 {
							reg = <2>;
							label = "lan3";
						};

						port3@3 {
							reg = <3>;
							label = "lan4";
						};

						port4@4 {
							reg = <4>;
							label = "lan5";
						};

						port5@5 {
							reg = <5>;
							label = "lan6";
						};

						port6@6 {
							reg = <6>;
							label = "uplink";
						};

						port8@8 {
							reg = <8>;
							label = "cpu";
							phy-mode = "rgmii-id";
							ethernet = <&mac1>;
							fixed-link {
								speed = <1000>;
								max-speed = <1000>;
								full-duplex;
							};
						};
					};
				};
			};
		};
	};

	fragment@3 {
		target = <&i2c0>;
		__overlay__ {
			status = "okay";
		};
	};

	fragment@4 {
		target = <&i2c6>;
		__overlay__ {
			status = "okay";
					pca9555: gpio-expander@20 {
						compatible = "nxp,pca9675";
						gpio-controller;
						#gpio-cells = <2>;
						reg = <0x20>;
					};
					sensors {
						label = "HWMON";
						compatible = "nuvoton,w83795g";
						reg = <0x2f>;
					};
					power {
						label = "POWER_BPB";
						compatible = "ti,ina219";
						reg = <0x40>;
					};
					tmp@48 {
						label = "TEMP_BPB";
						compatible = "national,lm75";
						reg = <0x48>;
					};
					tmp@49 {
						label = "TEMP_CB";
						compatible = "national,lm75";
						reg = <0x49>;
					};
		};
	};

	fragment@5 {
		target = <&i2c7>;
		__overlay__ {
			/* Common i2c */
			status = "okay";

			cio_26: gpio-expander@26 {
				compatible = "nxp,pca9675";
				gpio-controller;
				#gpio-cells = <2>;
				reg = <0x26>;
			};

			cio_29: gpio-expander@29 {
				compatible = "nxp,pca9675";
				gpio-controller;
				#gpio-cells = <2>;
				reg = <0x29>;
				lines-initial-states = <0x1>;
			};

			cio_2b: gpio-expander@2b {
				compatible = "nxp,pca9675";
				gpio-controller;
				#gpio-cells = <2>;
				reg = <0x2b>;
			};

					i2cmux@76 {
						compatible = "nxp,pca9548";
						#address-cells = <1>;
						#size-cells = <0>;
						reg = <0x76>;
						reset-gpios = <&pca9555 15 GPIO_ACTIVE_LOW>;
						i2c_node1: i2c@0 {
						    #address-cells = <1>;
						    #size-cells = <0>;
						    reg = <0>;
						};
						i2c_node2: i2c@1 {
						    #address-cells = <1>;
						    #size-cells = <0>;
						    reg = <1>;
						};
						i2c_node3: i2c@2 {
						    #address-cells = <1>;
						    #size-cells = <0>;
						    reg = <2>;
						};
						i2c_node4: i2c@3 {
						    #address-cells = <1>;
						    #size-cells = <0>;
						    reg = <3>;
						};
						i2c_node5: i2c@4 {
						    #address-cells = <1>;
						    #size-cells = <0>;
						    reg = <4>;
						};
						i2c_node6: i2c@5 {
						    #address-cells = <1>;
						    #size-cells = <0>;
						    reg = <5>;
						};
						i2c_node7: i2c@6 {
						    #address-cells = <1>;
						    #size-cells = <0>;
						    reg = <6>;
						};
						i2c_node8: i2c@7 {
						    #address-cells = <1>;
						    #size-cells = <0>;
						    reg = <7>;
						};
					};
		};
	};
#if 0
	fragment@6 {
		target = <&ahb>;
		__overlay__ {
	spi0 {
		compatible = "spi-gpio";
		#address-cells = <0x1>;
		ranges;

		cs-gpios = <&cio_29 15 0>;  /* CS */
		gpio-sck = <&cio_29 12 0>;  /* SK */
		gpio-mosi = <&cio_29 14 0>; /* DI */
		gpio-miso = <&cio_29 13 0>; /* DO */
		num-chipselects = <1>;

		spidev@0 {
			compatible = "mx25l25635e", "jedec,spi-nor";
			#address-cells = <1>;
			#size-cells = <0>;
			reg = <0>;
			spi-max-frequency = <1000000>;
/*			spi-cs-high; */
		};
		};
	};

	spi0 {
		compatible = "spi-gpio";
		#address-cells = <0x1>;
		ranges;

		cs-gpios = <&cio_29 15 0>;  /* CS */
		gpio-sck = <&cio_29 12 0>;  /* SK */
		gpio-mosi = <&cio_29 14 0>; /* DI */
		gpio-miso = <&cio_29 13 0>; /* DO */
		num-chipselects = <1>;

		spidev@0 {
			compatible = "mx25l25635e", "jedec,spi-nor";
			#address-cells = <1>;
			#size-cells = <0>;
			reg = <0>;
			spi-max-frequency = <1000000>;
/*			spi-cs-high; */
		};
		};
	};
	};
#endif
};
